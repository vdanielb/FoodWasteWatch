<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>U.S. Food-Waste Prototype</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="stylesheet" href="style.css">
  <script defer src="https://d3js.org/d3.v7.min.js"></script>
  <script defer src="https://unpkg.com/topojson-client@3"></script>
  <script defer src="scrollytelling.js"></script>
  <script defer src="main.js"></script>
  <style>
    #scrolly-foodwaste {
      position: relative;
      min-height: 500vh; /* Extended height for more scrolling space */
      max-width: 100vw; /* Use full viewport width */
      margin: 0; /* Remove margins */
      padding: 0; /* Remove padding */
      width: 100%;
    }
    
    /* Fixed layout container */
    .fixed-layout {
      position: sticky;
      top: 50vh;
      transform: translateY(-50%);
      display: grid;
      grid-template-columns: 500px 1fr 550px; /* trash area larger | empty space | food icons */
      gap: 80px; /* Increased gap to push elements further apart */
      align-items: center;
      justify-content: space-between; /* Space elements to edges */
      height: 450px; /* Increased height */
      width: 100vw; /* Full viewport width */
      max-width: none; /* Remove max-width constraint */
      margin: 0;
      padding: 0 2px; /* Minimal padding to allow maximum left space */
      pointer-events: none; /* Allow text boxes to pass through */
      box-sizing: border-box;
    }
    
    /* Container for trash animation and summary text */
    .trash-container {
      display: flex;
      flex-direction: column;
      align-items: center; /* Center both elements */
      gap: 20px;
      pointer-events: auto;
      margin-left: -80px; /* Push much further left */
      width: 100%;
    }
    
    /* Fixed trash animation on the left */
    .fixed-trash-animation {
      width: 400px; /* Enlarged */
      height: 400px; /* Enlarged */
      display: flex;
      justify-content: center;
      align-items: center;
      background: transparent; /* Removed background */
      border-radius: 0; /* Removed border radius */
      box-shadow: none; /* Removed shadow/border */
      pointer-events: auto; /* Re-enable for this element */
    }
    
    /* Summary text below trash animation */
    .trash-summary {
      text-align: center;
      font-size: 1.3em;
      font-weight: 600;
      color: #555;
      background: rgba(255, 255, 255, 0.9);
      padding: 15px 25px;
      border-radius: 0; /* Sharp edges to match design */
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      transition: all 0.3s ease;
      min-width: 200px;
      width: fit-content; /* Allow text to determine width */
      margin: 0 auto; /* Center within the container */
    }
    
    .trash-summary .amount {
      color: #e74c3c;
      font-weight: 700;
      font-size: 1.1em;
    }
    
    /* Food visualization area on the right */
    .food-visualization-area {
      width: 550px; /* Much larger width to use available space */
      height: 400px; /* Increased height to match trash animation */
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      background: transparent; /* Removed background to match trash animation */
      border-radius: 0; /* Removed border radius */
      box-shadow: none; /* Removed shadow/border */
      transition: all 0.3s ease, opacity 0.2s ease, transform 0.2s ease; /* Added smooth transitions */
      padding: 30px; /* Increased padding for better spacing */
      pointer-events: auto; /* Re-enable for this element */
      margin-left: auto; /* Push to far right */
    }
    
    /* Moving text boxes - now free to move across entire viewport */
    .moving-text-box {
      position: fixed;
      left: 50%;
      transform: translateX(-50%);
      width: 520px; /* Reduced from 600px */
      max-width: 90vw;
      padding: 35px 40px; /* Reduced padding */
      text-align: center;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(15px);
      border-radius: 0; /* Sharp edges - removed border radius */
      box-shadow: 0 10px 30px rgba(0,0,0,0.15);
      transition: transform 0.1s ease, opacity 0.3s ease;
      /* Initially positioned below the screen */
      top: 100vh;
      z-index: 100;
      opacity: 0;
    }
    
    .moving-text-box h2 {
      font-size: 1.6em; /* Reduced from 2em */
      margin: 0;
      font-weight: 700;
      line-height: 1.4;
      color: #333;
    }
    
    /* Active state for visible text box */
    .moving-text-box.active {
      opacity: 1;
    }
    
    .moving-text-box.passing {
      opacity: 0.3;
    }
    
    /* Extended scroll area for text movement */
    .extended-scroll-area {
      height: 200vh; /* Additional scrolling space */
      opacity: 0;
      pointer-events: none;
    }
    
    /* Enhanced text highlighting for numbers */
    .fw-day, .fw-month, .fw-year {
      color: #e74c3c;
      font-weight: 900;
      text-shadow: 0 0 5px rgba(231, 76, 60, 0.3);
      transition: all 0.3s ease;
    }
    
    /* Animation classes for content changes */
    .content-changing .food-visualization-area {
      transform: scale(1.03);
    }
    
    .content-changing .fixed-trash-animation {
      transform: scale(1.02);
    }
    
    /* Invisible scroll triggers */
    .scroll-trigger {
      height: 80vh;
      opacity: 0;
      pointer-events: none;
    }
    
    /* Responsive design */
    @media (max-width: 1400px) {
      .fixed-layout {
        grid-template-columns: 450px 1fr 500px;
        gap: 60px;
        padding: 0 2px;
      }
      
      .trash-container {
        margin-left: -60px; /* Much further left for smaller screens */
      }
      
      .fixed-trash-animation {
        width: 350px;
        height: 350px;
      }
      
      .food-visualization-area {
        width: 450px;
        height: 350px;
        padding: 25px;
      }
      
      .trash-summary {
        font-size: 1.2em;
        padding: 12px 20px;
      }
      
      .moving-text-box {
        width: 450px; /* Reduced */
        padding: 30px 35px; /* Reduced padding */
      }
      
      .moving-text-box h2 {
        font-size: 1.5em; /* Reduced */
      }
    }
    
    @media (max-width: 1200px) {
      .fixed-layout {
        grid-template-columns: 400px 1fr 400px;
        gap: 40px;
        padding: 0 1px;
      }
      
      .trash-container {
        margin-left: -50px; /* Much further left for smaller screens */
      }
      
      .fixed-trash-animation {
        width: 300px;
        height: 300px;
      }
      
      .food-visualization-area {
        width: 350px;
        height: 300px;
        padding: 20px;
      }
      
      .trash-summary {
        font-size: 1.1em;
        padding: 10px 18px;
      }
      
      .moving-text-box {
        width: 380px; /* Reduced */
        padding: 25px 30px; /* Reduced padding */
      }
      
      .moving-text-box h2 {
        font-size: 1.4em; /* Reduced */
      }
    }
    
    @media (max-width: 1000px) {
      .fixed-layout {
        grid-template-columns: 1fr;
        grid-template-rows: auto auto;
        gap: 40px;
        height: auto;
        padding: 20px;
        justify-content: center; /* Center on mobile */
      }
      
      .trash-container {
        order: 1;
        margin-left: 0; /* Reset on mobile */
        align-items: center; /* Ensure centering on mobile */
      }
      
      .food-visualization-area {
        order: 2;
      }
      
      .fixed-trash-animation,
      .food-visualization-area {
        width: 100%;
        max-width: 400px;
        justify-self: center;
        margin-left: 0; /* Reset margin on mobile */
      }
      
      .trash-summary {
        font-size: 1.0em;
        padding: 8px 15px;
      }
      
      .moving-text-box {
        width: 320px; /* Reduced */
        padding: 20px 25px; /* Reduced padding */
      }
      
      .moving-text-box h2 {
        font-size: 1.3em; /* Reduced */
      }
    }
    
    @media (max-width: 768px) {
      .fixed-trash-animation,
      .food-visualization-area {
        height: 250px;
        max-width: 350px;
      }
      
      .trash-summary {
        font-size: 0.9em;
        padding: 6px 12px;
      }
      
      .moving-text-box {
        width: 300px; /* Reduced */
        padding: 18px 22px; /* Reduced padding */
      }
      
      .moving-text-box h2 {
        font-size: 1.2em; /* Reduced */
      }
    }
  </style>
</head>

<body>
  <div class="newspaper-header">
    <h1>The Antiko Times</h1>
  </div>
  <header>
    <img src="images/food waste.webp" alt="Food Waste Visualization" class="header-image">
    <h1>Food Waste in the United States</h1>
    <h2 class="subtitle">A Visual Exploration of America's Food Waste Crisis</h2>
    <div class="scroll-indicator">
      <span>Scroll to explore</span>
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12 5v14M5 12l7 7 7-7"/>
      </svg>
    </div>
    <div id="food-waste-animation" style="width:100%; display:flex; justify-content:center; margin: 30px 0;"></div>
  </header>

  <section id="scrolly-foodwaste" class="scrollytelling">
    <!-- Fixed layout that stays in place while scrolling -->
    <div class="fixed-layout">
      <!-- Container for trash animation and summary text -->
      <div class="trash-container">
        <!-- Fixed trash animation on the left -->
        <div class="fixed-trash-animation" id="fixed-trash-animation"></div>
        <!-- Summary text that updates with current period -->
        <div class="trash-summary" id="trash-summary">
          <span class="amount" id="summary-amount">1</span> lb of food wasted per day
        </div>
      </div>
      
      <!-- Food visualization area on the right -->
      <div class="food-visualization-area" id="food-visualization-area"></div>
    </div>
    
    <!-- Moving text boxes that scroll through the entire viewport -->
    <div class="moving-text-box" id="text-box-1">
      <h2>The average American wastes around <span class="fw-day" id="day-number">XX</span> lb of food per day. It may not seem like much at first glance...</h2>
    </div>
    
    <div class="moving-text-box" id="text-box-2">
      <h2>But over the course of a month, this seemingly small amount accumulates to <span class="fw-month" id="month-number">XX</span> lbs of perfectly good food thrown away.</h2>
    </div>
    
    <div class="moving-text-box" id="text-box-3">
      <h2>And in a single year? That daily waste compounds into a staggering <span class="fw-year" id="year-number">XX</span> lbs of food discarded per person, enough to feed families for weeks.</h2>
    </div>
    
    <!-- Extended scroll area for the text movement -->
    <div class="extended-scroll-area"></div>
  </section>

  <div class="map-container">
    <button id="resetView" class="reset-button">Reset View</button>
    <div id="map" style="width:100%; height:500px;"></div>
  </div>

  <!-- Intro scrollytelling steps moved below the map -->
  <section class="scrollytelling">
    <div class="sticky-container">
      <div class="sticky-content">
        <!-- Step 1 — national tonnage -->
        <div class="step" data-step="1">
          <h2>Every year, Americans waste <span class="stat" id="stat-tons">75&nbsp;million&nbsp;tons</span> of food.</h2>
          <p class="sub">That's roughly 40 % of everything produced for the table.</p>
          <div class="animation-container" id="waste-animation-1"></div>
        </div>
        <!-- Step 2 — skyline comparison -->
        <div class="step" data-step="2">
          <h2>Stack it up and you could fill the Empire State Building <span class="stat" id="stat-esb">450</span> times.</h2>
          <p class="sub">Picture New York's iconic tower overflowing with leftovers—<em>every three days</em>.</p>
          <div class="animation-container" id="waste-animation-2"></div>
        </div>
        <!-- Step 3 — household dollars -->
        <div class="step" data-step="3">
          <h2>The lost food is worth <span class="stat" id="stat-value">$440&nbsp;billion</span>.</h2>
          <p class="sub">For the average family, that's <span class="stat" id="stat-household">$1,400</span> vanishing from the grocery budget each year.</p>
          <div class="animation-container" id="waste-animation-3"></div>
        </div>
      </div>
    </div>
  </section>

  <!-- Scrollytelling section -->
  <!-- TODO: Tristan -->
  <section class="scrollytelling">
    <div class="sticky-container">
      <div class="sticky-content">
        <!-- Step 4 — climate impact -->
        <div class="step" data-step="4">
          <h2>As it rots, wasted food emits as much CO₂e as <span class="stat" id="stat-cars">58&nbsp;million</span> cars.</h2>
          <p class="sub">That's every car in Texas <strong>and</strong> California combined.</p>
          <div class="animation-container" id="waste-animation-4"></div>
        </div>
  
        <!-- Step 5 — water footprint -->
        <div class="step" data-step="5">
          <h2>Growing that uneaten food guzzles <span class="stat" id="stat-water">21&nbsp;trillion</span> gallons of water.</h2>
          <p class="sub">Enough to fill <span class="stat" id="stat-pools">2.3&nbsp;million</span> Olympic swimming pools.</p>
          <div class="animation-container" id="waste-animation-5"></div>
        </div>
  
        <!-- Step 6 — land footprint -->
        <div class="step" data-step="6">
          <h2>It also ties up <span class="stat" id="stat-land">56&nbsp;million</span> acres of farmland.</h2>
          <p class="sub">That's an area larger than the state of <strong>Wisconsin</strong>.</p>
          <div class="animation-container" id="waste-animation-6"></div>
        </div>
  
        <!-- Step 7 — hunger offset -->
        <div class="step" data-step="7">
          <h2>Rescuing even <strong>just 10 %</strong> of wasted food could feed <span class="stat" id="stat-people">13&nbsp;million</span> Americans facing hunger.</h2>
          <div class="animation-container" id="waste-animation-7"></div>
        </div>
  
        <!-- Step 8 — personal savings -->
        <div class="step" data-step="8">
          <h2>Keeping half your leftovers each week could keep <span class="stat" id="stat-personal">$700</span> in your wallet every year.</h2>
          <p class="sub">That's two months of average utility bills.</p>
          <div class="animation-container" id="waste-animation-8"></div>
        </div>
  
        <!-- Step 9 — methane cut via compost -->
        <div class="step" data-step="9">
          <h2>Composting the scraps instead of landfilling them can slash methane by <span class="stat" id="stat-methane">34 %</span>.</h2>
          <div class="animation-container" id="waste-animation-9"></div>
        </div>
  
        <!-- Step 10 — job creation -->
        <div class="step" data-step="10">
          <h2>Food-recovery programs could create <span class="stat" id="stat-jobs">51,000</span> new U.S. jobs.</h2>
          <p class="sub">That's equivalent to the entire craft-brewing industry workforce.</p>
          <div class="animation-container" id="waste-animation-10"></div>
        </div>
  
      </div>
    </div>
  </section>

  <!-- Solutions and Conclusions section -->
  <!-- TODO: Clayton -->




  <section class="notes">
    <h2>Writeup</h2>
    <p> <br><b>What have you done so far? </b><br>

    <br> So far, we've created the main visualization for the project, which is a map that displays how much waste is generated across different states in the USA. We have hover and tooltips implemented in our map, but we intend to add more interactive features such as being able to click on a specific state to view the breakdown of waste based on sector. <br>
    
    <br> We've also set up a GitHub repository and deployed the webpage, so it's already accessible online. In addition, we plan to create a second visualization to complement the map, which takes a scrollytelling format, to put into perspective how much waste each person, household, city, etc is generating, on average. <br>
    
    <br><b> What will be the most challenging of your project to design and why? </b><br>
    
    <br> The most challenging aspect will likely be designing and implementing the animations for the scrollytelling section, which requires good technical execution and also creativity in how we present the data in a meaningful and relatable way. We need to create a compelling narrative that clearly communicates the main insights while still being easy to understand. Then, we aim to add more interactive elements to keep the webpage engaging and informative for users. <br> 
    
    <br> Lastly, it will also be a challenge to improve the performance of our visualization to make it more seamless. <br></p>
    
    <h2>Data</h2>
    <p>ReFED U.S. State Food Surplus Summary, 2010-2023.</p>
  </section>

</body>
</html>
